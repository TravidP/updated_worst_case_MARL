graph TD
    %% 全局样式设置
    accTitle: CNN Actor-Critic Network Architecture
    accDescr: A diagram showing the data flow from input observations through CNN layers to policy and value outputs.

    %% 节点定义
    Input([Input: ob_fw<br/>Shape: None, 200]):::input
    Reshape[Reshape to 5x5x8]:::op
    
    Conv1[[Conv2D: 32 filters<br/>3x3, Padding: Same, ReLU]]:::layer
    Conv2[[Conv2D: 64 filters<br/>3x3, Padding: Valid, ReLU]]:::layer
    
    Flatten[Flatten to 576]:::op
    SharedDense[[Dense Layer: 128<br/>Activation: ReLU]]:::layer
    
    %% Heads
    PiHead[[Policy Head: Dense n_a<br/>Softmax]]:::actor
    VHead[[Value Head: Dense 1<br/>Linear]]:::critic
    Squeeze[Squeeze Operation]:::op
    
    %% 输出
    PiOut[/Output: pi /]:::actor
    VOut[/Output: v_preds /]:::critic

    %% 连接逻辑
    Input --> Reshape
    Reshape --> Conv1
    Conv1 -->|Shape: 5, 5, 32| Conv2
    Conv2 -->|Shape: 3, 3, 64| Flatten
    Flatten --> SharedDense
    
    SharedDense --- Branch{Split}
    Branch --> PiHead
    Branch --> VHead
    
    PiHead --> PiOut
    VHead --> Squeeze
    Squeeze --> VOut

    %% 样式表
    classDef input fill:#ffffff,stroke:#333,stroke-width:2px
    classDef layer fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef op fill:#f5f5f5,stroke:#9e9e9e,stroke-dasharray: 5 5
    classDef actor fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px
    classDef critic fill:#fff3e0,stroke:#ef6c00,stroke-width:2px